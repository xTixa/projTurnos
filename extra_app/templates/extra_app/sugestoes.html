{% extends 'home/base.html' %}
{% load static %}
{% block title %}Sugestões{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/sugestoes/CSS_sugestoes.css' %}">
{% endblock %}

{% block sb_info_active %}is-active{% endblock %}

{% block content %}

<div class="section-tabs">
  <a href="{% url 'extra_app:sugestao' %}" class="active">Sugerir</a>
  <a href="{% url 'extra_app:sugestoes_todas' %}">Todas</a>
</div>

<section class="sugestoes-hero">
  <div class="hero-text">
    <h1>Caixa de sugestões do DI</h1>
    <p>A tua opinião ajuda a melhorar o Departamento de Engenharia Informática.</p>
    <p class="hero-frase">Sugere hoje o que gostavas de ver amanhã na ESTGV.</p>
  </div>
  <div class="hero-image-wrapper">
    <img src="{% static 'img/unnamed.jpg' %}" alt="Sugestão" class="sugestao-image">
  </div>
</section>

<section id="sec-populares" class="top5-wrapper">
  <h2>Mais votadas</h2>
  <p>Top 5 sugestões mais apoiadas pelos estudantes.</p>

  <div class="sugestoes-scroll">
    {% for s in sugestoes_top %}
      <article class="sugestao-card">
        <p class="sugestao-texto">{{ s.texto }}</p>
        <small class="sugestao-autor">Enviada por {{ s.autor_nome }}</small>
        <form action="{% url 'extra_app:feedback_sugestao' s.id %}" method="post">
          {% csrf_token %}
          <button class="like-btn {% if s.user_liked %}active-like{% endif %}"
                  type="submit" name="acao" value="like">
            <i class="fa fa-thumbs-up"></i> {{ s.Like|length }}
          </button>
          <button class="dislike-btn {% if s.user_disliked %}active-dislike{% endif %}"
                  type="submit" name="acao" value="dislike">
            <i class="fa fa-thumbs-down"></i> {{ s.Dislike|length }}
          </button>
        </form>
      </article>
    {% empty %}
      <p>Ainda não há sugestões votadas. Envia a primeira.</p>
    {% endfor %}
  </div>
</section>

<section class="sugestao-form-wrapper">
  <h2>Partilha a tua sugestão</h2>
  <p>Ideias sobre aulas, espaços, serviços ou eventos são bem-vindas.</p>

  {% if mensagem %}
    <p class="mensagem-sucesso">{{ mensagem }}</p>
  {% endif %}

  <form method="post" class="sugestao-form">
    {% csrf_token %}
    <textarea name="texto" rows="4"
              placeholder="Escreve aqui a tua sugestão para o departamento."></textarea>
    <button type="submit">Enviar sugestão</button>
  </form>
  <footer class="sugestoes-footer">
    <p class="nota-anonima">Sugestões ofensivas ou inapropriadas serão eliminadas.</p>
  </footer>
</section>

{% endblock %}