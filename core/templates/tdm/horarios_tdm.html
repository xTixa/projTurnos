{% extends "home/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/ei/horarios.css' %}">
{% endblock %}

{% block content %}
<section class="horarios-hero">
  <div class="horarios-inner">

    <h1>Horários — Tecnologia e Design Multimédia</h1>
    <p>Consulta aqui os horários.</p>

    {% if request.session.user_id %}
      <div class="inscricao-btn-wrapper">
        <a href="{% url 'home:inscricao_turno' %}" class="btn-inscricao">
          <i class="fa-solid fa-check"></i>
          Inscrever-me no Turno
        </a>
      </div>
    {% endif %}

    <!-- ABAS -->
    <ul class="nav nav-tabs horarios-tabs" role="tablist">
      {% for item in horarios_por_ano %}
        <li class="nav-item" role="presentation">
          <button
            class="nav-link {% if forloop.first %}active{% endif %}"
            data-bs-toggle="tab"
            data-bs-target="#ano-{{ item.ano.id_anocurricular }}"
            type="button"
            role="tab">
            {{ item.ano.ano_curricular }}
          </button>
        </li>
      {% endfor %}
    </ul>

    <!-- CONTEÚDO DAS ABAS -->
    <div class="tab-content horarios-content">
      {% for item in horarios_por_ano %}
        <div
          class="tab-pane fade {% if forloop.first %}show active{% endif %}"
          id="ano-{{ item.ano.id_anocurricular }}"
          role="tabpanel">

          {% if item.pdf %}
            <div class="horario-card">
              <p class="text-muted mb-4">
                O horário encontra-se disponível em formato PDF.
              </p>

              <div class="horario-actions">
                <a href="{{ item.pdf.ficheiro.url }}"
                   class="btn btn-primary"
                   target="_blank">
                  <i class="fa-regular fa-file-pdf"></i> Ver Horário
                </a>

                <a href="{{ item.pdf.ficheiro.url }}"
                   class="btn btn-outline-secondary"
                   download>
                  <i class="fa-solid fa-download"></i> Download
                </a>
              </div>
            </div>
          {% else %}
            <div class="horario-card empty">
              <p class="text-muted">
                Ainda não existe horário para {{ item.ano.ano_curricular }}.
              </p>
            </div>
          {% endif %}

        </div>
      {% endfor %}
    </div>

  </div>
</section>
{% endblock %}
